using System;
using System.Collections.Generic;
using System.Text;
using System.Windows.Forms;

namespace DesFirePersonalizer
{
    class CloseAllForms
    {
        ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        delegate void CloseMethod(Form form);
        static public void CloseForm(Form form)
        {
            if (!form.IsDisposed)
            {
                if (form.InvokeRequired)
                {
                    CloseMethod method = new CloseMethod(CloseForm);
                    form.Invoke(method, new object[] { form });
                }
                else { form.Close(); }
            }
        }
        ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        static public void CloseAllOpenForms()
        {
            Form[] forms = OpenForms; // get array because collection changes as we close forms
            foreach (Form form in forms) { CloseForm(form); } // close every open form
        }
        ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        static public void CloseAllChildForms()
        {
            Form[] forms = OpenForms; // get array because collection changes as we close forms
            foreach (Form form in forms) { if (form.Name != "MainPage") { CloseForm(form); } } // close every open form
        }
        ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        public static Form[] OpenForms
        {
            get
            {
                Form[] forms = null;
                int count = Application.OpenForms.Count;
                forms = new Form[count];
                if (count > 0)
                {
                    int index = 0;
                    foreach (Form form in Application.OpenForms) { forms[index++] = form; }
                }
                return forms;
            }
        }
        ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        static private void OpenForm()
        {
            Form form = new Form();
            form.Text = Guid.NewGuid().ToString();
            form.Show();
        }
        ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        static private void OpenFormNewThread()
        {
            Form form = new Form();
            form.Text = Guid.NewGuid().ToString();
            form.ShowDialog();
        }
     

        ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        public static bool isOpenFrm()
        {
            FormCollection forms = Application.OpenForms;
            foreach (Form form in Application.OpenForms) { if (form.Name == "EnrollmentFrm") {  }  }
            if (forms.Count == 0 || forms.Count == 1) { return false; } else { return true; }
        }
        ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    }
}

